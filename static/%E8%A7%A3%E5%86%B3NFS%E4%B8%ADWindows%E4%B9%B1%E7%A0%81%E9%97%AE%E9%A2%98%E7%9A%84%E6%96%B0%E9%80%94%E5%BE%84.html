<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="generator" content="TiddlyWiki" />
<meta name="tiddlywiki-version" content="5.3.3" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="mobile-web-app-capable" content="yes"/>
<meta name="format-detection" content="telephone=no">
<link rel="canonical" href="https://wiki.fspark.me/static/%25E8%25A7%25A3%25E5%2586%25B3NFS%25E4%25B8%25ADWindows%25E4%25B9%25B1%25E7%25A0%2581%25E9%2597%25AE%25E9%25A2%2598%25E7%259A%2584%25E6%2596%25B0%25E9%2580%2594%25E5%25BE%2584.html" />
<link id="faviconLink" rel="shortcut icon" href="favicon.ico">
<link rel="stylesheet" href="static.css">
<title>解决NFS中Windows乱码问题的新途径: FSpark's wiki — A eternal non-linear personal web notebook</title>
</head>
<body class="tc-body">
<p><center>
<div>


This page is part of a static HTML representation of the TiddlyWiki at <a href="https://wiki.fspark.me/#%E8%A7%A3%E5%86%B3NFS%E4%B8%ADWindows%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98%E7%9A%84%E6%96%B0%E9%80%94%E5%BE%84"> https://wiki.fspark.me/#解决NFS中Windows乱码问题的新途径</a><br><br>
此页面为TiddlyWiki生成的部分静态网页，全站请访问 <a href="https://wiki.fspark.me/#%E8%A7%A3%E5%86%B3NFS%E4%B8%ADWindows%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98%E7%9A%84%E6%96%B0%E9%80%94%E5%BE%84"> https://wiki.fspark.me/#解决NFS中Windows乱码问题的新途径</a>
  

</div>
</center></p>
<section class="tc-story-river tc-static-story-river">
<p><div class="tc-tiddler-frame tc-tiddler-view-frame tc-tiddler-exists " data-tags="" data-tiddler-title="解决NFS中Windows乱码问题的新途径" role="article">






  
  <div class="gk0wk-notionpagebg gk0wk-notionpagebg-n">
    <div class="gk0wk-notionbg-addbuttons">
      <button class="" title="Add Icon">😁 Add Icon</button>
      <button class="" title="Add Cover"><svg class="tc-image-picture tc-image-button" height="22pt" viewBox="0 0 128 128" width="22pt"><path d="M112 68.233v-48.23A4.001 4.001 0 00107.997 16H20.003A4.001 4.001 0 0016 20.003v38.31l9.241-14.593c2.8-4.422 9.023-5.008 12.6-1.186l18.247 20.613 13.687-6.407a8 8 0 018.903 1.492 264.97 264.97 0 002.92 2.739 249.44 249.44 0 006.798 6.066 166.5 166.5 0 002.106 1.778c2.108 1.747 3.967 3.188 5.482 4.237.748.518 1.383.92 2.044 1.33.444.117 1.046.144 1.809.05 1.873-.233 4.238-1.144 6.723-2.547a36.016 36.016 0 003.205-2.044c.558-.4.93-.686 1.07-.802.376-.31.765-.577 1.165-.806zM0 8.007A8.01 8.01 0 018.007 0h111.986A8.01 8.01 0 01128 8.007v111.986a8.01 8.01 0 01-8.007 8.007H8.007A8.01 8.01 0 010 119.993V8.007zM95 42a8 8 0 100-16 8 8 0 000 16zM32 76c15.859 4.83 20.035 7.244 20.035 12S32 95.471 32 102.347c0 6.876 1.285 4.99 1.285 9.653H68s-13.685-6.625-13.685-10.8c0-7.665 10.615-8.34 10.615-13.2 0-7.357-14.078-8.833-32.93-12z" fill-rule="evenodd"></path></svg> Add Cover</button>
    </div>
  </div>









<div class="tc-tiddler-title"><div class="tc-titlebar"><span class="tc-tiddler-controls"><button aria-expanded="false" aria-label="更多" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fmore-tiddler-actions" title="更多操作"></button><div class=" tc-reveal" hidden="true"></div><span class=" tc-reveal"><button aria-expanded="false" aria-label="信息" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Finfo" title="显示此条目的信息"></button></span><span class=" tc-reveal" hidden="true"></span> <button aria-label="favorites" class="tc-btn-invisible tc-btn-%24%3A%2Fplugins%2Fkookma%2Ffavorites%2Fui%2Fbuttons%2Fadd-remove" title="Add to favorites">
     
		 
 </button><button aria-expanded="false" aria-label="Page TOC" class="tc-btn-invisible tc-btn-%24%3A%2Fplugins%2FGk0Wk%2Fpage-toc%2FPageTOCButton" title="Show TOC of this tiddler"></button><div class="tc-popup-keep tc-reveal" hidden="true"></div><button aria-label="编辑" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fedit" title="编辑此条目"></button><button aria-label="关闭" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fclose" title="关闭此条目"></button></span><span class=" tc-popup-handle tc-popup-absolute"><h2 class="tc-title">解决NFS中Windows乱码问题的新途径</h2></span></div><div class="tc-tiddler-info tc-popup-handle tc-reveal" hidden="true"></div></div><div class="tc-reveal"></div>
<div class=" tc-reveal"><div class="tc-subtitle"><a class="tc-tiddlylink tc-tiddlylink-resolves tc-popup-handle tc-popup-absolute" href="FSpark.html">FSpark</a> 2023年01月15日 10:03</div></div><div class=" tc-reveal"><div class="tc-tags-wrapper"></div></div><div class="tc-tiddler-body tc-reveal"><h1 class="">先决条件：</h1><ul><li>盘为 NTFS，ext4 等支持硬链的文件系统</li><li>安装 Node.js 环境</li></ul><h1 class="">网上目前的解决方案：</h1><blockquote class="tc-quote"><p>Windows 中官方的 NFS 支持提供的 mount 不支持 UTF-8 编码，导致了乱码的产生。如果需要 Windows 支持，考虑以下一些方法：</p><ul><li>使用 fuse-convmvfs 修改服务端文件的编码，详见此 Super User 上的回答。</li><li>找一个别的 Windows 的 NFS 客户端。</li><li>如果正在使用新版的 Windows 10，在区域设置中启用 Beta 版本的 UTF-8 支持。注意这可能会导致一部分软件出现乱码。</li></ul><p>如果要取消挂载，使用 umount 即可。
</p><cite><a class="tc-tiddlylink-external" href="https://lug.ustc.edu.cn/planet/2019/08/NFS-intro/#windows" rel="noopener noreferrer" target="_blank">一个 NFS 的简介 - LUG @ USTC</a></cite></blockquote><p>以下是结果：</p><ul><li>fuse-convmvfs <ul><li>用了，但映射出来的盘文件列表是空的。（可能和不能硬链有关？）</li></ul></li><li>别的Windows NFS客户端<ul><li>还没试过</li></ul></li><li>Windows Beta UTF-8 支持<ul><li>试过，会导致原本一些正常的软件出错，而且是有多离谱多离谱</li></ul></li></ul><h1 class="">新方案</h1><p>受 fuse-convmvfs, pnpm 和 calibre 启发的，用硬连接映射出个音译后文件名的安全目录不就好了</p><p>用到两个库，自己缝合一下就好了</p><ul><li><a class="tc-tiddlylink-external" href="https://github.com/likun7981/hlink" rel="noopener noreferrer" target="_blank">likun7981/hlink: 批量、快速硬链工具(The batch, fast hard link toolkit)</a></li><li><a class="tc-tiddlylink-external" href="https://github.com/dzcpy/transliteration" rel="noopener noreferrer" target="_blank">dzcpy/transliteration: UTF-8 to ASCII transliteration / slugify module for node.js, browser, Web Worker, React Native, Electron and CLI.</a></li></ul><p>再指个路：<code>packages/core/src/utils/index.ts/getOriginalDestPath()</code></p><p>什么？说了这么多要我自己缝合？</p><p>嗯，因为发现我的exFAT不支持硬链接甚至软连接就没心思再整了。嗯？你说为啥不用NTFS？我就从NTFS来的，正常的Android无法OTG挂载哦。</p><p>一个能被内核直接支持且性能优异的方案却落得如此下场。</p></div>
<div class=" tc-reveal">

</div>




</div></p>
</section>
</body>
</html>

