<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="generator" content="TiddlyWiki" />
<meta name="tiddlywiki-version" content="5.3.3" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="mobile-web-app-capable" content="yes"/>
<meta name="format-detection" content="telephone=no">
<link rel="canonical" href="https://wiki.fspark.me/static/TiddlyWiki%2520Node.js%2520%25E4%25BC%25A0%25E8%25BE%2593%25E4%25BC%2598%25E5%258C%2596.html" />
<link id="faviconLink" rel="shortcut icon" href="favicon.ico">
<link rel="stylesheet" href="static.css">
<title>TiddlyWiki Node.js 传输优化: FSpark's wiki — A eternal non-linear personal web notebook</title>
</head>
<body class="tc-body">
<p><center>
<div>


This page is part of a static HTML representation of the TiddlyWiki at <a href="https://wiki.fspark.me/#TiddlyWiki%20Node.js%20%E4%BC%A0%E8%BE%93%E4%BC%98%E5%8C%96"> https://wiki.fspark.me/#TiddlyWiki Node.js 传输优化</a><br><br>
此页面为TiddlyWiki生成的部分静态网页，全站请访问 <a href="https://wiki.fspark.me/#TiddlyWiki%20Node.js%20%E4%BC%A0%E8%BE%93%E4%BC%98%E5%8C%96"> https://wiki.fspark.me/#TiddlyWiki Node.js 传输优化</a>
  

</div>
</center></p>
<section class="tc-story-river tc-static-story-river">
<p><div class="tc-tiddler-frame tc-tiddler-view-frame tc-tiddler-exists  tc-tagged-TiddlyWiki%20Node.js%E7%AB%AF%E4%BC%98%E5%8C%96" data-tags="[[TiddlyWiki Node.js端优化]]" data-tiddler-title="TiddlyWiki Node.js 传输优化" role="article">






  
  <div class="gk0wk-notionpagebg gk0wk-notionpagebg-n">
    <div class="gk0wk-notionbg-addbuttons">
      <button class="" title="Add Icon">😁 Add Icon</button>
      <button class="" title="Add Cover"><svg class="tc-image-picture tc-image-button" height="22pt" viewBox="0 0 128 128" width="22pt"><path d="M112 68.233v-48.23A4.001 4.001 0 00107.997 16H20.003A4.001 4.001 0 0016 20.003v38.31l9.241-14.593c2.8-4.422 9.023-5.008 12.6-1.186l18.247 20.613 13.687-6.407a8 8 0 018.903 1.492 264.97 264.97 0 002.92 2.739 249.44 249.44 0 006.798 6.066 166.5 166.5 0 002.106 1.778c2.108 1.747 3.967 3.188 5.482 4.237.748.518 1.383.92 2.044 1.33.444.117 1.046.144 1.809.05 1.873-.233 4.238-1.144 6.723-2.547a36.016 36.016 0 003.205-2.044c.558-.4.93-.686 1.07-.802.376-.31.765-.577 1.165-.806zM0 8.007A8.01 8.01 0 018.007 0h111.986A8.01 8.01 0 01128 8.007v111.986a8.01 8.01 0 01-8.007 8.007H8.007A8.01 8.01 0 010 119.993V8.007zM95 42a8 8 0 100-16 8 8 0 000 16zM32 76c15.859 4.83 20.035 7.244 20.035 12S32 95.471 32 102.347c0 6.876 1.285 4.99 1.285 9.653H68s-13.685-6.625-13.685-10.8c0-7.665 10.615-8.34 10.615-13.2 0-7.357-14.078-8.833-32.93-12z" fill-rule="evenodd"></path></svg> Add Cover</button>
    </div>
  </div>









<div class="tc-tiddler-title"><div class="tc-titlebar"><span class="tc-tiddler-controls"><button aria-expanded="false" aria-label="更多" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fmore-tiddler-actions" title="更多操作"></button><div class=" tc-reveal" hidden="true"></div><span class=" tc-reveal"><button aria-expanded="false" aria-label="信息" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Finfo" title="显示此条目的信息"></button></span><span class=" tc-reveal" hidden="true"></span> <button aria-label="favorites" class="tc-btn-invisible tc-btn-%24%3A%2Fplugins%2Fkookma%2Ffavorites%2Fui%2Fbuttons%2Fadd-remove" title="Add to favorites">
     
		 
 </button><button aria-expanded="false" aria-label="Page TOC" class="tc-btn-invisible tc-btn-%24%3A%2Fplugins%2FGk0Wk%2Fpage-toc%2FPageTOCButton" title="Show TOC of this tiddler"></button><div class="tc-popup-keep tc-reveal" hidden="true"></div><button aria-label="编辑" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fedit" title="编辑此条目"></button><button aria-label="关闭" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fclose" title="关闭此条目"></button></span><span class=" tc-popup-handle tc-popup-absolute"><h2 class="tc-title">TiddlyWiki Node.js 传输优化</h2></span></div><div class="tc-tiddler-info tc-popup-handle tc-reveal" hidden="true"></div></div><div class="tc-reveal"></div>
<div class=" tc-reveal"><div class="tc-subtitle"><a class="tc-tiddlylink tc-tiddlylink-resolves tc-popup-handle tc-popup-absolute" href="FSpark.html">FSpark</a> 2022年07月21日 16:13</div></div><div class=" tc-reveal"><div class="tc-tags-wrapper"><span class="tc-tag-list-item" data-tag-title="TiddlyWiki Node.js端优化"><span aria-expanded="false" class="tc-tag-label tc-btn-invisible" draggable="true" style="fill:#FFFFFF;color:#FFFFFF;">TiddlyWiki Node.js端优化</span><span class="tc-drop-down tc-reveal" hidden="true"></span></span></div></div><div class="tc-tiddler-body tc-reveal"><p>许多用户认为转到Node.js性能便能得到大幅提升，在这先打碎各位的幻想，缕一缕Node.js模式下的几点误区：</p><ol><li>仍是全文加载<ul><li>你所想象的REST交互的B/S模式在初次加载时并不成立</li><li>优雅的即用即取是懒加载模式(Lazyload)</li></ul></li><li>只是同步方便<ul><li></li></ul></li><li>附件会全部读进内存<ul><li>在Node.js模式下存储的二进制文件都是Base64编码后存进.tid里的</li><li>生成的时候会全部读进内存环境，浏览器内也是</li><li>Base64编码是原始二进制编码文件大小的4/3</li></ul></li></ol><p>但我们还是有办法去优化，下面请看：</p><h2 class="">附件使用引用链接</h2><p>使用_canonical_uri，这样就换成浏览器去请求这一地址，而不是一开始就包含整个文件。</p><h2 class="">使用Gzip，开启缓存化</h2><p><code>gzip=yes use-browser-cache=yes</code>
Gzip能压缩传输流，尤其对与TiddlyWiki这样的纯文本，能大幅减小文件大小。开启浏览器缓存可以使浏览器不用每次都请求完整的文件。</p><p><a class="tc-tiddlylink-external" href="https://tiddlywiki.com/#ListenCommand" rel="noopener noreferrer" target="_blank">ListenCommand</a></p><h2 class="">外置Core缓存</h2><p>是的，你没看错，由于TiddlyWiki的微内核架构，保留启动模块，我们可以将整个内核外部化为一个js文件，得益于浏览器缓存，我们就可以省去每次都从服务器获取一遍。</p><p><a class="tc-tiddlylink-external" href="https://tiddlywiki.com/#Using%20the%20external%20JavaScript%20template" rel="noopener noreferrer" target="_blank">Using the external JavaScript template</a></p><h2 class="">外置插件缓存</h2><h2 class="">Lazyload</h2><p><a class="tc-tiddlylink-external" href="https://tiddlywiki.com/#LazyLoading" rel="noopener noreferrer" target="_blank">Lazyload</a></p><p>注意：懒加载后由于没有加载全文进内存，所以无法在浏览器中全文搜索。</p><h2 class="">ServiceWorker</h2><p>上面提到的外置缓存虽然是缓存了，但之后的访问还是需要再先向服务器确认一遍，为了免除这一时延，我们可以使用ServiceWorker来进行本地缓存。应用之后程序会直接加载本地缓存，之后再在后台更新最新的内核框架。</p><p>由于是通过workbox对生成后的静态文件进行的Hash来确定文件是否更新，所以在Node.js中因为响应都是动态的反而行不通，但作为发布中的一环也拿来讲了。</p><p><a class="tc-tiddlylink-external" href="https://wiki.onetwo.ren/#%24%3A%2Fplugins%2Flinonetwo%2Fservice-worker" rel="noopener noreferrer" target="_blank">https://wiki.onetwo.ren/#%24%3A%2Fplugins%2Flinonetwo%2Fservice-worker</a></p></div>
<div class=" tc-reveal">

</div>




</div></p>
</section>
</body>
</html>

